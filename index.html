<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<title>Gesture Star Text</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family: 'Poppins', sans-serif;
}
video{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:1;
  transition:opacity .6s ease;
}
canvas{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:100%;
  z-index:2;
}
#hint{
  position:fixed;
  bottom:20px;
  width:100%;
  text-align:center;
  color:rgba(255,255,255,.35);
  font-size:14px;
  letter-spacing:2px;
  z-index:3;
}
</style>
</head>
<body>

<video id="cam" autoplay playsinline muted></video>
<canvas id="fx"></canvas>
<div id="hint">âœ‹ tahan tangan di depan kamera</div>

<!-- MEDIAPIPE -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
const video = document.getElementById('cam');
const canvas = document.getElementById('fx');
const ctx = canvas.getContext('2d');

let W,H;
function resize(){
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize',resize);

// ===== STAR PARTICLES =====
let stars=[];
let exploded=false;
let showText=false;
let textAlpha=0;

function spawnStars(){
  stars=[];
  for(let i=0;i<400;i++){
    stars.push({
      x:Math.random()*W,
      y:Math.random()*H,
      tx:W/2,
      ty:H/2,
      vx:0,vy:0
    });
  }
}
spawnStars();

function updateStars(){
  ctx.clearRect(0,0,W,H);

  if(!exploded){
    stars.forEach(s=>{
      s.vx+=(s.tx-s.x)*0.002;
      s.vy+=(s.ty-s.y)*0.002;
      s.x+=s.vx;
      s.y+=s.vy;

      ctx.fillStyle='white';
      ctx.fillRect(s.x,s.y,2,2);
    });
  }else{
    stars.forEach(s=>{
      s.x+=s.vx;
      s.y+=s.vy;
      ctx.fillStyle='white';
      ctx.fillRect(s.x,s.y,2,2);
    });
  }

  if(showText){
    textAlpha=Math.min(textAlpha+0.02,1);
    ctx.fillStyle=`rgba(255,255,255,${textAlpha})`;
    ctx.shadowColor='white';
    ctx.shadowBlur=25;
    ctx.font='bold 72px Poppins';
    ctx.textAlign='center';
    ctx.fillText('UNTUK ADINDA',W/2,H/2);
    ctx.shadowBlur=0;
  }
}

// ===== HAND DETECTION =====
let handStable=0;
const hands = new Hands({
  locateFile:(f)=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});
hands.setOptions({
  maxNumHands:1,
  modelComplexity:1,
  minDetectionConfidence:0.7,
  minTrackingConfidence:0.7
});

hands.onResults(res=>{
  if(res.multiHandLandmarks){
    handStable++;
    if(handStable>25 && !exploded){
      explode();
    }
  }else{
    handStable=0;
  }
});

const camera = new Camera(video,{
  onFrame:async()=>{
    await hands.send({image:video});
  },
  width:640,
  height:480
});
camera.start();

function explode(){
  exploded=true;
  document.getElementById('hint').style.opacity=0;
  video.style.opacity=0;

  stars.forEach(s=>{
    const a=Math.random()*Math.PI*2;
    const sp=5+Math.random()*6;
    s.vx=Math.cos(a)*sp;
    s.vy=Math.sin(a)*sp;
  });

  setTimeout(()=>{
    showText=true;
    setTimeout(()=>{
      video.style.opacity=1;
    },1200);
  },600);
}

// ===== LOOP =====
function loop(){
  updateStars();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
